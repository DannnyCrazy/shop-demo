import{C as e,D as t,F as n,T as r,c as i,d as a,et as o,g as s,h as c,i as l,k as u,m as d}from"./pinia-DWP-ePKp.js";import{a as f,n as p,r as m}from"./index-CRfUK4JQ.js";var h={class:`container mx-auto px-4 py-8`},g={key:0,class:`text-center py-20 bg-white rounded shadow`},_={key:1,class:`grid grid-cols-1 lg:grid-cols-3 gap-6`},v={class:`lg:col-span-2 bg-white rounded shadow overflow-hidden`},y={class:`w-20 h-20 bg-gray-100 rounded flex-shrink-0`},b=[`src`],x={class:`flex-1`},S={class:`font-bold text-lg`},C={class:`text-sm text-gray-500 mt-1`},w={class:`text-right`},T={class:`text-primary font-bold text-lg`},E={class:`text-gray-500`},D=[`onClick`],O={class:`bg-white rounded shadow p-6 h-fit`},k={class:`flex justify-between mb-2`},A={class:`flex justify-between mb-4 text-xl font-bold`},j={class:`text-primary`},M=s({__name:`Cart`,setup(s){let M=m(),N=p(),P=f();async function F(){if(!N.isAuthenticated){P.push(`/login`);return}try{(await fetch(`/api/orders`,{method:`POST`,headers:{"Content-Type":`application/json`,Authorization:`Bearer ${N.token}`},body:JSON.stringify({items:M.items,user_id:N.user?.id,contact_info:{name:N.user?.username,phone:`13800000000`}})})).ok?(M.clearCart(),alert(`下单成功！`),P.push(`/orders`)):alert(`下单失败`)}catch{alert(`网络错误`)}}return(s,f)=>{let p=t(`router-link`);return e(),a(`div`,h,[f[5]||=i(`h2`,{class:`text-2xl font-bold mb-6`},`购物车`,-1),n(M).items.length===0?(e(),a(`div`,g,[f[1]||=i(`p`,{class:`text-gray-500 mb-4`},`购物车空空如也`,-1),c(p,{to:`/`,class:`text-primary hover:underline`},{default:u(()=>[...f[0]||=[d(`去选购`,-1)]]),_:1})])):(e(),a(`div`,_,[i(`div`,v,[(e(!0),a(l,null,r(n(M).items,t=>(e(),a(`div`,{key:t.id,class:`p-4 border-b flex gap-4`},[i(`div`,y,[i(`img`,{src:t.image||`https://placehold.co/100`,class:`w-full h-full object-cover`},null,8,b)]),i(`div`,x,[i(`h3`,S,o(t.name),1),i(`div`,C,[i(`p`,null,`发货: `+o(t.delivery),1),i(`p`,null,`规格: `+o(t.specs.sectionSize)+` | `+o(t.specs.length)+`mm`,1)])]),i(`div`,w,[i(`p`,T,`¥`+o(t.price),1),i(`p`,E,`x `+o(t.quantity),1),i(`button`,{onClick:e=>n(M).removeFromCart(t.id),class:`text-red-500 text-sm mt-2 hover:underline`},`删除`,8,D)])]))),128))]),i(`div`,O,[f[4]||=i(`h3`,{class:`text-lg font-bold mb-4 border-b pb-2`},`结算信息`,-1),i(`div`,k,[f[2]||=i(`span`,null,`商品总数`,-1),i(`span`,null,o(n(M).count),1)]),i(`div`,A,[f[3]||=i(`span`,null,`总计`,-1),i(`span`,j,`¥`+o(n(M).total.toFixed(2)),1)]),i(`button`,{onClick:F,class:`w-full bg-primary text-white py-3 rounded font-bold hover:bg-blue-700 transition`},` 立即结算 `)])]))])}}});export{M as default};