import{C as e,O as t,T as n,U as r,_ as i,b as a,c as o,d as s,f as c,l,o as u,p as d,r as f,t as p,v as m,w as h}from"./auth-byHFbW31.js";import{a as g,i as _}from"./index-COKga09v.js";import{t as v}from"./createLucideIcon-B-HlhbAx.js";var y=v(`plus`,[[`path`,{d:`M5 12h14`,key:`1ays0h`}],[`path`,{d:`M12 5v14`,key:`s699le`}]]),b=v(`square-pen`,[[`path`,{d:`M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7`,key:`1m0v6g`}],[`path`,{d:`M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z`,key:`ohrbg2`}]]),x=v(`trash-2`,[[`path`,{d:`M10 11v6`,key:`nco0om`}],[`path`,{d:`M14 11v6`,key:`outv1u`}],[`path`,{d:`M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6`,key:`miytrc`}],[`path`,{d:`M3 6h18`,key:`d0wm0j`}],[`path`,{d:`M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2`,key:`e791ji`}]]),S={class:`flex justify-between items-center mb-6`},C={class:`bg-white rounded shadow overflow-hidden`},w={class:`w-full text-left`},T={class:`p-4`},E={class:`p-4 font-medium`},D={class:`p-4`},O={class:`p-4`},k={class:`p-4 flex gap-2`},A=[`onClick`],j=[`onClick`],M={key:0,class:`fixed inset-0 bg-black/50 flex items-center justify-center z-50`},N={class:`bg-white rounded-lg p-6 w-full max-w-lg`},P={class:`text-xl font-bold mb-4`},F={class:`grid grid-cols-2 gap-4`},I={class:`flex justify-end gap-2 mt-4`},L=d({__name:`ProductList`,setup(d){let v=p(),L=n([]),R=n(!0),z=n(!1),B=n(!1),V=h({id:0,name:``,description:``,price:0,stock:0,category:`profile`,model_url:``,doc_url:``});async function H(){try{L.value=await(await fetch(`/api/products`)).json()}finally{R.value=!1}}function U(){B.value=!1,Object.assign(V,{id:0,name:``,description:``,price:0,stock:0,category:`profile`,model_url:``,doc_url:``}),z.value=!0}function W(e){B.value=!0,Object.assign(V,e),z.value=!0}async function G(){let e=B.value?`/api/products/${V.id}`:`/api/products`,t=B.value?`PUT`:`POST`;try{(await fetch(e,{method:t,headers:{"Content-Type":`application/json`,Authorization:`Bearer ${v.token}`},body:JSON.stringify(V)})).ok?(z.value=!1,H()):alert(`保存失败`)}catch{alert(`网络错误`)}}async function K(e){if(confirm(`确认删除?`))try{await fetch(`/api/products/${e}`,{method:`DELETE`,headers:{Authorization:`Bearer ${v.token}`}}),H()}catch{}}return i(H),(n,i)=>(m(),l(`div`,null,[u(`div`,S,[i[8]||=u(`h2`,{class:`text-2xl font-bold`},`商品管理`,-1),u(`button`,{onClick:U,class:`bg-primary text-white px-4 py-2 rounded flex items-center gap-2 hover:bg-blue-700`},[c(t(y),{class:`w-4 h-4`}),i[7]||=s(` 新增商品 `,-1)])]),u(`div`,C,[u(`table`,w,[i[9]||=u(`thead`,{class:`bg-gray-50 border-b`},[u(`tr`,null,[u(`th`,{class:`p-4 font-medium text-gray-500`},`ID`),u(`th`,{class:`p-4 font-medium text-gray-500`},`名称`),u(`th`,{class:`p-4 font-medium text-gray-500`},`价格`),u(`th`,{class:`p-4 font-medium text-gray-500`},`库存`),u(`th`,{class:`p-4 font-medium text-gray-500`},`操作`)])],-1),u(`tbody`,null,[(m(!0),l(f,null,a(L.value,e=>(m(),l(`tr`,{key:e.id,class:`border-b hover:bg-gray-50`},[u(`td`,T,r(e.id),1),u(`td`,E,r(e.name),1),u(`td`,D,`¥`+r(e.price),1),u(`td`,O,r(e.stock),1),u(`td`,k,[u(`button`,{onClick:t=>W(e),class:`text-blue-600 hover:text-blue-800`},[c(t(b),{class:`w-4 h-4`})],8,A),u(`button`,{onClick:t=>K(e.id),class:`text-red-600 hover:text-red-800`},[c(t(x),{class:`w-4 h-4`})],8,j)])]))),128))])])]),z.value?(m(),l(`div`,M,[u(`div`,N,[u(`h3`,P,r(B.value?`编辑商品`:`新增商品`),1),u(`form`,{onSubmit:g(G,[`prevent`]),class:`space-y-3`},[u(`div`,null,[i[10]||=u(`label`,{class:`block text-sm font-medium mb-1`},`名称`,-1),e(u(`input`,{"onUpdate:modelValue":i[0]||=e=>V.name=e,class:`w-full border rounded px-3 py-2`,required:``},null,512),[[_,V.name]])]),u(`div`,null,[i[11]||=u(`label`,{class:`block text-sm font-medium mb-1`},`描述`,-1),e(u(`textarea`,{"onUpdate:modelValue":i[1]||=e=>V.description=e,class:`w-full border rounded px-3 py-2`},null,512),[[_,V.description]])]),u(`div`,F,[u(`div`,null,[i[12]||=u(`label`,{class:`block text-sm font-medium mb-1`},`价格`,-1),e(u(`input`,{"onUpdate:modelValue":i[2]||=e=>V.price=e,type:`number`,step:`0.01`,class:`w-full border rounded px-3 py-2`,required:``},null,512),[[_,V.price,void 0,{number:!0}]])]),u(`div`,null,[i[13]||=u(`label`,{class:`block text-sm font-medium mb-1`},`库存`,-1),e(u(`input`,{"onUpdate:modelValue":i[3]||=e=>V.stock=e,type:`number`,class:`w-full border rounded px-3 py-2`,required:``},null,512),[[_,V.stock,void 0,{number:!0}]])])]),u(`div`,null,[i[14]||=u(`label`,{class:`block text-sm font-medium mb-1`},`模型URL (如 /AH-GB01-4080D-L50-8.stl)`,-1),e(u(`input`,{"onUpdate:modelValue":i[4]||=e=>V.model_url=e,class:`w-full border rounded px-3 py-2`},null,512),[[_,V.model_url]])]),u(`div`,null,[i[15]||=u(`label`,{class:`block text-sm font-medium mb-1`},`文档URL (如 /document.pdf)`,-1),e(u(`input`,{"onUpdate:modelValue":i[5]||=e=>V.doc_url=e,class:`w-full border rounded px-3 py-2`},null,512),[[_,V.doc_url]])]),u(`div`,I,[u(`button`,{type:`button`,onClick:i[6]||=e=>z.value=!1,class:`px-4 py-2 border rounded text-gray-600 hover:bg-gray-100`},`取消`),i[16]||=u(`button`,{type:`submit`,class:`px-4 py-2 bg-primary text-white rounded hover:bg-blue-700`},`保存`,-1)])],32)])])):o(``,!0)]))}});export{L as default};